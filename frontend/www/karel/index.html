<!doctype html>
<html>
	<head>
		<title>Karel</title>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
		<script src="jquery-ui-1.10.2.custom.min.js" ></script>
		<script src="codemirror.js" ></script>
		<script src="codemirror-karelpascal.js" ></script>
		<script src="codemirror-karelruby.js" ></script>
		<link rel="stylesheet" href="codemirror.css">
		<link rel="stylesheet" href="jquery-ui-1.10.2.custom.min.css">
		<script type="text/javascript" src="karelpascal.js"></script>
		<script type="text/javascript" src="karelruby.js"></script>
		<script type="text/javascript" src="karel.js"></script>
		<script type="text/javascript" src="karelide.js"></script>
		<style type="text/css">
			#world table { border-collapse: collapse; }
			#world table, #world th, #world td { border: 1px solid #ccc; }
			#world td { min-width: 30px; height: 30px; font-size: 10px; line-height: 30px; text-align: center; padding: 0; background: #eee; }
			#world th { min-width: 30px; height: 30px; font-size: 10px; line-height: 30px; text-align: center; padding: 0; background: #fff; }
			#world table.edit td.west:hover { background: url("data:image/png;encoding=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QMQARM5SuUrswAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAANUlEQVQI1y3HwQ0AIAgEwT2BxALov1ETzwfOb+RubEbVQvqXsBcRZGITASR7c84ESKoA7p0/Y+cNYdZpjgAAAAAASUVORK5CYII=") repeat-y; background-position: 0 0; }
			#world table.edit td.north:hover { background: url("data:image/png;encoding=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QMQARM5SuUrswAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAANUlEQVQI1y3HwQ0AIAgEwT2BxALov1ETzwfOb+RubEbVQvqXsBcRZGITASR7c84ESKoA7p0/Y+cNYdZpjgAAAAAASUVORK5CYII=") repeat-x; background-position: 0 0; }
			#world table.edit td.east:hover { background: url("data:image/png;encoding=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QMQARM5SuUrswAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAANUlEQVQI1y3HwQ0AIAgEwT2BxALov1ETzwfOb+RubEbVQvqXsBcRZGITASR7c84ESKoA7p0/Y+cNYdZpjgAAAAAASUVORK5CYII=") repeat-y; background-position: 100% 0;  }
			#world table.edit td.south:hover { background: url("data:image/png;encoding=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QMQARM5SuUrswAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAANUlEQVQI1y3HwQ0AIAgEwT2BxALov1ETzwfOb+RubEbVQvqXsBcRZGITASR7c84ESKoA7p0/Y+cNYdZpjgAAAAAASUVORK5CYII=") repeat-x; background-position: 0 100%;  }
			#world table.edit td.none:hover { background: #ccc; }
			#world .buzzer-edit { width: 26px; height: 26px; margin: 0; padding: 0; border: 0; }
			#world div.karel { position: absolute; font-size: 34px; line-height: 34px; min-width: 34px; text-align: center; }
			#world .toolbar { padding: 4px; display: inline-block; font-size: 10px; }
			/* support: IE7 */
			*+html #world .toolbar { display: inline; }
			
			#source, .CodeMirror { position: absolute; top: 0px; left: 700px; width: 600px; height: 600px; }
			#log { position: absolute; top: 610px; left: 700px; width: 600px; height: 100px; border: 1px solid #000; font-family: monospace; overflow-y: auto; }
			.opcode { background: #eee; }
			.down { font-weight: bold; }
			
			.breakpoints {width: .8em;}
			.breakpoint { color: #822; }
			.CodeMirror {border: 1px solid #aaa;}
			.CodeMirror .active { background: #ff9; }
			span.cm-builtin { color: #060 !important; }
			span.cm-operator { color: #900 !important; }
		</style>
	</head>
	<body>
		<div id="world">
		<script type="application/x-karel-input"><ejecucion>
  <condiciones instruccionesMaximasAEjecutar="10000000" longitudStack="65000" />
  <mundos>
    <mundo nombre="mundo_0" ancho="100" alto="100">
      <monton x="11" y="6" zumbadores="1"/>
      <monton x="11" y="7" zumbadores="1"/>
      <monton x="11" y="8" zumbadores="1"/>
      <monton x="11" y="9" zumbadores="1"/>
      <monton x="11" y="10" zumbadores="1"/>
      <monton x="11" y="11" zumbadores="1"/>
      <monton x="11" y="12" zumbadores="1"/>
      <monton x="11" y="13" zumbadores="1"/>
      <monton x="11" y="14" zumbadores="1"/>
      <monton x="11" y="15" zumbadores="1"/>
      <monton x="11" y="16" zumbadores="1"/>
      <monton x="12" y="6" zumbadores="1"/>
      <monton x="12" y="7" zumbadores="2"/>
      <monton x="12" y="16" zumbadores="1"/>
      <monton x="13" y="6" zumbadores="1"/>
      <monton x="13" y="8" zumbadores="1"/>
      <monton x="13" y="9" zumbadores="1"/>
      <monton x="13" y="10" zumbadores="1"/>
      <monton x="13" y="11" zumbadores="1"/>
      <monton x="13" y="12" zumbadores="1"/>
      <monton x="13" y="13" zumbadores="1"/>
      <monton x="13" y="14" zumbadores="1"/>
      <monton x="13" y="16" zumbadores="1"/>
      <monton x="14" y="6" zumbadores="1"/>
      <monton x="14" y="8" zumbadores="1"/>
      <monton x="14" y="14" zumbadores="1"/>
      <monton x="14" y="16" zumbadores="1"/>
      <monton x="15" y="6" zumbadores="1"/>
      <monton x="15" y="8" zumbadores="1"/>
      <monton x="15" y="10" zumbadores="1"/>
      <monton x="15" y="11" zumbadores="1"/>
      <monton x="15" y="12" zumbadores="1"/>
      <monton x="15" y="14" zumbadores="1"/>
      <monton x="15" y="16" zumbadores="1"/>
      <monton x="16" y="6" zumbadores="1"/>
      <monton x="16" y="8" zumbadores="1"/>
      <monton x="16" y="10" zumbadores="1"/>
      <monton x="16" y="11" zumbadores="2"/>
      <monton x="16" y="12" zumbadores="1"/>
      <monton x="16" y="14" zumbadores="1"/>
      <monton x="16" y="16" zumbadores="1"/>
      <monton x="17" y="6" zumbadores="1"/>
      <monton x="17" y="8" zumbadores="1"/>
      <monton x="17" y="10" zumbadores="1"/>
      <monton x="17" y="11" zumbadores="1"/>
      <monton x="17" y="12" zumbadores="1"/>
      <monton x="17" y="14" zumbadores="1"/>
      <monton x="17" y="16" zumbadores="1"/>
      <monton x="18" y="6" zumbadores="1"/>
      <monton x="18" y="8" zumbadores="1"/>
      <monton x="18" y="14" zumbadores="1"/>
      <monton x="18" y="16" zumbadores="1"/>
      <monton x="19" y="6" zumbadores="1"/>
      <monton x="19" y="8" zumbadores="1"/>
      <monton x="19" y="9" zumbadores="1"/>
      <monton x="19" y="10" zumbadores="1"/>
      <monton x="19" y="11" zumbadores="1"/>
      <monton x="19" y="12" zumbadores="1"/>
      <monton x="19" y="13" zumbadores="1"/>
      <monton x="19" y="14" zumbadores="1"/>
      <monton x="19" y="16" zumbadores="1"/>
      <monton x="20" y="6" zumbadores="1"/>
      <monton x="20" y="16" zumbadores="1"/>
      <monton x="21" y="6" zumbadores="1"/>
      <monton x="21" y="7" zumbadores="1"/>
      <monton x="21" y="8" zumbadores="1"/>
      <monton x="21" y="9" zumbadores="1"/>
      <monton x="21" y="10" zumbadores="1"/>
      <monton x="21" y="11" zumbadores="1"/>
      <monton x="21" y="12" zumbadores="1"/>
      <monton x="21" y="13" zumbadores="1"/>
      <monton x="21" y="14" zumbadores="1"/>
      <monton x="21" y="15" zumbadores="1"/>
      <monton x="21" y="16" zumbadores="1"/>
      <posicionDump x="16" y="11" />
    </mundo>
  </mundos>
  <programas tipoEjecucion="CONTINUA" intruccionesCambioContexto="1" milisegundosParaPasoAutomatico="0">
    <programa nombre="p1" ruta="{$2$}" mundoDeEjecucion="mundo_0" xKarel="12" yKarel="15" direccionKarel="ESTE" mochilaKarel="0" >
      <despliega tipo="MUNDO" />
    </programa>
  </programas>
</ejecucion></script></div>
		<textarea id="source">#!ruby

def gira-derecha
    3 veces
        gira-izquierda
    fin
fin

def toma-todo
    mientras junto-a-zumbador
        coge-zumbador
    fin
fin

def gira(n)
    n veces
        gira-izquierda
    fin
fin

si orientado-al-norte y no-junto-a-zumbador
    avanza
    gira-izquierda
    mientras frente-libre y (orientado-al-norte u orientado-al-sur)
        avanza
    fin
    gira(10)
fin
</textarea>
<!--iniciar-programa
    define-nueva-instruccion gira-derecha como inicio
        repetir 3 veces gira-izquierda;
    fin;
    
    define-nueva-instruccion lado como inicio
        mientras no-junto-a-zumbador hacer inicio
            avanza;
            si junto-a-zumbador entonces inicio
            	coge-zumbador;
                si junto-a-zumbador entonces inicio
                    coge-zumbador;
                fin sino inicio
                    gira-izquierda;
                    gira-izquierda;
                    avanza;
                    gira-izquierda;
                    deja-zumbador;
                fin;
            fin;
        fin;
        avanza;
    fin;
    
    define-nueva-instruccion cuadro como inicio
        si junto-a-zumbador entonces inicio
            coge-zumbador;
            coge-zumbador;
        fin;
        
        { Detecta si se est&aacute; en el centro de la diana. }
        avanza;
        si junto-a-zumbador entonces inicio
            coge-zumbador;
            si junto-a-zumbador entonces inicio
                coge-zumbador;
            fin sino inicio
                deja-zumbador;
                gira-izquierda;
                gira-izquierda;
                avanza;
                mientras algun-zumbador-en-la-mochila hacer inicio
                    deja-zumbador;
            	    avanza;
            	    deja-zumbador;
            	    gira-izquierda;
            	    gira-izquierda;
            	    avanza;
                fin;
                apagate;
            fin;
        fin;
        
        repetir 4 veces inicio
            si junto-a-zumbador entonces inicio
               coge-zumbador;
               coge-zumbador;
            fin;
            lado;
        fin;
        
        { Avanza al siguiente nivel de la diana. }
        avanza;
        gira-derecha;
        avanza;
        avanza;
        gira-izquierda;
        
        { Recursividad para hacer un ciclo infinito. }
        cuadro;
    fin;
              
    inicia-ejecucion
        cuadro;
    termina-ejecucion
finalizar-programa-->
	</body>
</html>
