<template>
  <div class="wait_for_ajax panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">{{ T.wordsProblems }}</h3>
    </div>
    <table class="table problem-list">
      <thead>
        <tr>
          <th class="contains-long-desc">{{ T.wordsTitle }}</th>
          <th class="numericColumn">{{ T.wordsQuality }}</th>
          <th class="numericColumn">{{ T.wordsDifficulty }}</th>
          <th class="numericColumn">{{ T.wordsRatio }}</th>
          <th class="numericColumn">
            {{ T.wordsPointsForRank }} <a data-toggle="tooltip"
                href="https://blog.omegaup.com/el-nuevo-ranking-de-omegaup/"
                rel="tooltip"
                title=""
                v-bind:data-original-title="T.wordsPointsForRankTooltip"><img src=
                "/media/question.png"></a>
          </th>
          <th class="numericColumn"
              v-if="loggedIn == '1'">{{ T.wordsMyScore }}</th>
        </tr>
      </thead>
      <tbody>
        <tr v-bind:class="problem.visibility &gt;= 2 ? 'high-quality':''"
            v-for="problem in problems">
          <td>
            <span class="glyphicon glyphicon-ban-circle"
                title="T.wordsBannedProblem"
                v-if="problem.visibility &lt; 0"></span> <span class=
                "glyphicon glyphicon-eye-close"
                title="T.wordsPrivate"
                v-else-if="problem.visibility == 0"></span> <img src="/media/quality-badge-sm.png"
                title="T.wordsHighQualityProblem"
                v-else-if="problem.visibility &gt;= 2"> <a v-bind:href=
                "`/arena/problem/${problem.alias}`">{{ problem.title }}</a>
            <div class="tag-list"
                 v-bind:title="`${problem.tags.map(tag =&gt; tag.name).join(' ')}`"
                 v-if="problem.tags.length">
              <a v-bind:class="tag.autogenerated === '1' ? 'tag-autogenerated':'tag'"
                   v-bind:href=
                   "`/problem/?tag[]=${currentTags ? `${currentTags.join('&amp;tag[]=')}${currentTags.includes(tag.name) ? '':`&amp;tag[]=${tag.name}`}` : `${tag.name}`}`"
                   v-for="tag in problem.tags">{{ tag.name }}</a>
            </div>
          </td>
          <td class="numericColumn"
              v-if="problem.quality === null">—</td>
          <td class="tooltip_column"
              v-else=""><span data-wenk-pos="right"
                v-bind:data-wenk="`${parseFloat(problem.quality).toFixed(1)} ${T.wordsOutOf4}`">{{
                qualityTags[parseInt(problem.quality)] }}</span></td>
          <td class="numericColumn"
              v-if="problem.difficulty === null">—</td>
          <td class="tooltip_column"
              v-else=""><span data-wenk-pos="right"
                v-bind:data-wenk=
                "`${parseFloat(problem.difficulty).toFixed(1)} ${T.wordsOutOf4}`">{{
                difficultyTags[parseInt(problem.difficulty)] }}</span></td>
          <td class="numericColumn">{{ parseFloat(100.0 * problem.ratio).toFixed(2) }}%</td>
          <td class="numericColumn">{{ parseFloat(problem.points).toFixed(2) }}</td>
          <td class="numericColumn"
              v-if="loggedIn == '1'">{{ parseFloat(problem.score).toFixed(2) }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</template>

<style>
.tag, .tag-autogenerated {
  margin-right: .25em;
}
</style>

<script>
import {T} from '../../omegaup.js';
export default {
  props: {
    problems: Array,
    loggedIn: String,
    currentTags: Array,
  },
  data: function() {
    return {
      T: T, qualityTags:
                [
                  T.wordsPoor,
                  T.wordsFair,
                  T.wordsGood,
                  T.wordsExcellent,
                  T.wordsExcellent
                ],
          difficultyTags:[
            T.wordsVeryEasy,
            T.wordsEasy,
            T.wordsMedium,
            T.wordsHard,
            T.wordsHard
          ],
    }
  },
}
</script>
