#!/bin/bash

set -e

OMEGAUP_ROOT="$(/usr/bin/git rev-parse --show-toplevel)"

# Run full linter to fix issues on all changed files
echo "Running lint fixes..."
"${OMEGAUP_ROOT}/stuff/lint.sh" fix || {
  # If lint.sh made changes, add them to the commit
  echo "Lint fixes applied. Adding changes to commit..."
  git add -u
}

# Run validation to ensure no warnings or errors remain
echo "Validating code quality..."
"${OMEGAUP_ROOT}/stuff/lint.sh" validate

